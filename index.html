
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø§Ù„Ù…Ù„ÙƒÙŠØ© | Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…Ø³ØªÙ‚Ù„</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=El+Messiri:wght@400;700;900&display=swap');
        
        :root {
            --royal-gold: #D4AF37;
            --palace-black: #050505;
        }

        body, html { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            overflow: hidden; font-family: 'El Messiri', sans-serif;
            background: #000; color: var(--royal-gold);
        }

        #canvas-container { width: 100%; height: 100%; cursor: move; }

        .royal-panel {
            background: rgba(8, 8, 8, 0.98);
            border: 2px solid var(--royal-gold);
            box-shadow: 0 0 50px rgba(212, 175, 55, 0.3);
            backdrop-filter: blur(20px);
            border-radius: 30px;
            transition: transform 0.6s cubic-bezier(0.19, 1, 0.22, 1);
        }

        #interaction-panel {
            position: fixed; bottom: 20px; left: 50%;
            transform: translateX(-50%) translateY(120%);
            width: 90%; max-width: 900px; z-index: 2000;
        }

        #interaction-panel.active { transform: translateX(-50%) translateY(0); }

        .crown-marker {
            position: absolute; width: 60px; height: 60px;
            background: radial-gradient(circle, var(--royal-gold), #8B6B0D);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            color: black; font-size: 1.8rem; cursor: pointer;
            box-shadow: 0 0 30px var(--royal-gold);
            z-index: 1000; border: 3px solid #fff;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 20px var(--royal-gold); }
            50% { transform: scale(1.1); box-shadow: 0 0 40px var(--royal-gold); }
            100% { transform: scale(1); box-shadow: 0 0 20px var(--royal-gold); }
        }

        .tab-btn { opacity: 0.4; padding: 12px 24px; transition: 0.4s; font-weight: 900; font-size: 1.2rem; }
        .tab-btn.active { opacity: 1; border-bottom: 4px solid var(--royal-gold); color: white; }

        #gate-screen {
            position: fixed; inset: 0; z-index: 9999;
            background: radial-gradient(circle at center, #1a1a1a 0%, #000 100%);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
    </style>
</head>
<body>

    <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ø¨ÙˆØ§Ø¨Ø© -->
    <div id="gate-screen">
        <div class="text-center p-6">
            <div class="text-8xl mb-8">ğŸ›ï¸</div>
            <h1 class="text-6xl md:text-8xl font-black text-yellow-500 mb-4 tracking-tighter">Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø§Ù„Ù…Ù„ÙƒÙŠØ©</h1>
            <p class="text-2xl text-yellow-800 mb-12 italic font-bold">Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…Ø³ØªÙ‚Ù„ - Ù„Ø§ ÙŠØ­ØªØ§Ø¬ Ù„Ø§ØªØµØ§Ù„</p>
            <button id="enter-btn" class="px-20 py-6 bg-yellow-600 hover:bg-yellow-500 text-black font-black text-2xl rounded-full shadow-[0_0_40px_rgba(212,175,55,0.4)] transition-all hover:scale-105 active:scale-95">
                Ø¨Ø¯Ø¡ Ø§Ù„ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ©
            </button>
            <div class="mt-10 text-zinc-600 flex gap-8 justify-center text-lg">
                <span><i class="fas fa-keyboard mr-2"></i>W A S D Ù„Ù„ØªØ­Ø±Ùƒ</span>
                <span><i class="fas fa-mouse mr-2"></i>Ø§Ø³Ø­Ø¨ Ø§Ù„Ù…Ø§ÙˆØ³ Ù„Ù„Ù†Ø¸Ø±</span>
            </div>
        </div>
    </div>

    <!-- Ù„ÙˆØ­Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ -->
    <div id="interaction-panel" class="royal-panel p-8 md:p-12">
        <div class="flex items-center justify-between mb-8 border-b border-yellow-900/30 pb-6">
            <div class="flex gap-6">
                <button onclick="showTab('story')" id="tab-story" class="tab-btn active">Ø§Ù„Ø­ÙƒØ§ÙŠØ©</button>
                <button onclick="showTab('rules')" id="tab-rules" class="tab-btn">Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯</button>
                <button onclick="showTab('quiz')" id="tab-quiz" class="tab-btn">Ø§Ù„ØªØ­Ø¯ÙŠ</button>
            </div>
            <h2 id="display-title" class="text-3xl font-black text-yellow-500">Ø§Ù„Ø£Ø«Ø± Ø§Ù„Ù…Ù„ÙƒÙŠ</h2>
        </div>

        <div class="h-72 overflow-y-auto px-4 mb-8 text-white text-2xl leading-relaxed font-medium" id="content-area"></div>

        <div class="flex gap-6">
            <button id="speak-btn" class="flex-grow bg-gradient-to-r from-yellow-700 to-yellow-500 text-black font-black py-5 rounded-2xl text-2xl flex items-center justify-center gap-4 hover:brightness-110">
                <i class="fas fa-volume-up"></i> Ø§Ø³ØªÙ…Ø¹ Ù„Ù„Ù†Ø·Ù‚ Ø§Ù„Ù…Ù„ÙƒÙŠ
            </button>
            <button onclick="closeUI()" class="px-12 bg-zinc-900 text-zinc-400 rounded-2xl font-black hover:text-white transition-colors">Ø±Ø¬ÙˆØ¹</button>
        </div>
    </div>

    <div id="canvas-container"></div>
    <div id="markers-layer"></div>

    <script>
        // Ø¯Ø§ØªØ§Ø¨ÙŠØ³ Ù…Ø¯Ù…Ø¬Ø© Ù„Ø¶Ù…Ø§Ù† Ø¹Ø¯Ù… Ø§Ù„Ø­Ø§Ø¬Ø© Ù„Ù„Ø§ØªØµØ§Ù„
        const ROYAL_DATABASE = {
            'mask': {
                name: 'Ù‚Ù†Ø§Ø¹ ØªÙˆØª Ø¹Ù†Ø® Ø¢Ù…ÙˆÙ†',
                story: "ÙŠØ§ Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø­Ø¶Ø±Ø© Ø§Ù„Ù…Ù„Ùƒ Ø§Ù„Ø´Ø§Ø¨. Ù‡Ø°Ø§ Ø§Ù„Ù‚Ù†Ø§Ø¹ Ø§Ù„Ø°Ù‡Ø¨ÙŠ Ù„ÙŠØ³ Ù…Ø¬Ø±Ø¯ Ù‚Ø·Ø¹Ø© Ø£Ø«Ø±ÙŠØ©ØŒ Ø¨Ù„ Ù‡Ùˆ Ù…Ø¹Ø¬Ø²Ø© ÙÙ†ÙŠØ© ØµÙ†Ø¹Øª Ù…Ù† Ø§Ù„Ø°Ù‡Ø¨ Ø§Ù„Ø®Ø§Ù„Øµ ÙˆØ§Ù„Ø£Ø­Ø¬Ø§Ø± Ø§Ù„ÙƒØ±ÙŠÙ…Ø© Ù„ÙŠØ¹ÙŠØ´ Ø§Ù„Ù…Ù„Ùƒ Ù„Ù„Ø£Ø¨Ø¯ ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø¢Ø®Ø±. Ø§Ù†Ø¸Ø± Ø¨Ø¯Ù‚Ø© ÙˆØ³ØªØ´Ø¹Ø± Ø¨Ù‡ÙŠØ¨Ø© Ø§Ù„ÙØ±Ø§Ø¹Ù†Ø©.",
                rules: "Ù‚Ø§Ø¹Ø¯Ø© Ù…Ù„ÙƒÙŠØ©: Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø¯ÙŠØ« Ø¹Ù† Ø§Ù„Ù…Ù„ÙˆÙƒØŒ Ù†Ø³ØªØ®Ø¯Ù… Ø£ÙØ¹Ø§Ù„ Ø§Ù„ØªØ¹Ø¸ÙŠÙ…. Ù…Ø«Ø§Ù„: 'ØªÙØ¶Ù„ Ø¬Ù„Ø§Ù„ØªÙ‡ Ø¨Ø§Ù„ÙƒÙ„Ø§Ù…'.",
                quiz: { q: "Ù…Ù…Ø§ ØµÙ†Ø¹ Ø§Ù„Ù‚Ù†Ø§Ø¹ Ø§Ù„Ù…Ù„ÙƒÙŠØŸ", opts: ["Ø°Ù‡Ø¨ Ø®Ø§Ù„Øµ ÙˆØ£Ø­Ø¬Ø§Ø± ÙƒØ±ÙŠÙ…Ø©", "ÙØ¶Ø© Ù…Ø·Ù„ÙŠØ© Ø¨Ø§Ù„Ø°Ù‡Ø¨"], a: "Ø°Ù‡Ø¨ Ø®Ø§Ù„Øµ ÙˆØ£Ø­Ø¬Ø§Ø± ÙƒØ±ÙŠÙ…Ø©" }
            },
            'nefertiti': {
                name: 'ØªÙ…Ø«Ø§Ù„ Ù†ÙØ±ØªÙŠØªÙŠ',
                story: "Ù†ÙØ±ØªÙŠØªÙŠØŒ ÙˆØªØ¹Ù†ÙŠ 'Ø§Ù„Ø¬Ù…ÙŠÙ„Ø© Ø£ØªØª'. Ù‡ÙŠ Ø±Ù…Ø² Ø§Ù„Ø¬Ù…Ø§Ù„ ÙˆØ§Ù„Ù‚ÙˆØ© ÙÙŠ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ØµØ±ÙŠ. ØªÙ…Ø«Ø§Ù„Ù‡Ø§ Ø§Ù„Ù†ØµÙÙŠ Ù‡Ø°Ø§ ÙŠØ¹ØªØ¨Ø± Ù…Ù† Ø£ÙƒØ«Ø± Ø§Ù„Ù‚Ø·Ø¹ Ø¯Ù‚Ø©ØŒ Ø­ÙŠØ« ÙŠØ¸Ù‡Ø± Ù…Ù„Ø§Ù…Ø­ Ø§Ù„ÙˆØ¬Ù‡ Ø§Ù„Ù…Ù„ÙƒÙŠØ© Ø¨Ù…Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆØ§Ù‚Ø¹ÙŠØ© ÙˆØ§Ù„Ø´Ù…ÙˆØ®.",
                rules: "Ù‚Ø§Ø¹Ø¯Ø© Ù…Ù„ÙƒÙŠØ©: Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø£Ø¹Ù„Ø§Ù… Ø§Ù„Ù…Ø¤Ù†Ø«Ø© Ù„Ø§ ØªÙ†ÙˆÙ† ÙÙŠ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©ØŒ Ù…Ø«Ù„: 'Ù†ÙØ±ØªÙŠØªÙŠÙ Ù…Ù„ÙƒØ©ÙŒ'.",
                quiz: { q: "Ù…Ø§Ø°Ø§ ÙŠØ¹Ù†ÙŠ Ø§Ø³Ù… Ù†ÙØ±ØªÙŠØªÙŠØŸ", opts: ["Ø§Ù„Ø¬Ù…ÙŠÙ„Ø© Ø£ØªØª", "Ø´Ù…Ø³ Ø§Ù„Ø³Ù…Ø§Ø¡"], a: "Ø§Ù„Ø¬Ù…ÙŠÙ„Ø© Ø£ØªØª" }
            },
            'scribe': {
                name: 'Ø§Ù„ÙƒØ§ØªØ¨ Ø§Ù„Ø¬Ø§Ù„Ø³',
                story: "Ù‡Ø°Ø§ Ø§Ù„ÙƒØ§ØªØ¨ ÙŠÙ…Ø«Ù„ Ù‚Ù…Ø© Ø§Ù„Ø¹Ù„Ù… ÙÙŠ Ù…ØµØ± Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©. ÙƒØ§Ù† Ø§Ù„ÙƒÙØªÙ‘Ø§Ø¨ Ù‡Ù… Ø¹ØµØ¨ Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ©ØŒ ÙˆØ­ÙØ¸Ø© Ø£Ø³Ø±Ø§Ø± Ø§Ù„Ù…Ù„Ùƒ. Ø§Ù†Ø¸Ø± Ø¥Ù„Ù‰ Ø¹ÙŠÙ†ÙŠÙ‡ Ø§Ù„Ù…ØµÙ†ÙˆØ¹ØªÙŠÙ† Ù…Ù† Ø§Ù„ÙƒÙˆØ§Ø±ØªØ²ØŒ ÙƒØ£Ù†Ù‡ ÙŠÙ‚Ø±Ø£ Ø£ÙÙƒØ§Ø±Ùƒ ÙˆÙŠØ¯ÙˆÙ†Ù‡Ø§ Ø§Ù„Ø¢Ù†.",
                rules: "Ù‚Ø§Ø¹Ø¯Ø© Ù…Ù„ÙƒÙŠØ©: Ø§Ù„Ù…Ø¨ØªØ¯Ø£ Ø§Ù„Ù…Ø±ÙÙˆØ¹ Ù‡Ùˆ Ø£Ø³Ø§Ø³ Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„Ø§Ø³Ù…ÙŠØ©ØŒ ØªÙ…Ø§Ù…Ø§Ù‹ ÙƒÙ…Ø§ Ø§Ù„ÙƒØ§ØªØ¨ Ù‡Ùˆ Ø£Ø³Ø§Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©.",
                quiz: { q: "Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„ØªÙŠ ØµÙ†Ø¹Øª Ù…Ù†Ù‡Ø§ Ø¹ÙŠÙ†Ø§ Ø§Ù„ÙƒØ§ØªØ¨ØŸ", opts: ["Ø§Ù„ÙƒÙˆØ§Ø±ØªØ² ÙˆØ§Ù„ÙƒØ±ÙŠØ³ØªØ§Ù„", "Ø§Ù„Ø²Ø¬Ø§Ø¬ Ø§Ù„Ù…Ù„ÙˆÙ†"], a: "Ø§Ù„ÙƒÙˆØ§Ø±ØªØ² ÙˆØ§Ù„ÙƒØ±ÙŠØ³ØªØ§Ù„" }
            }
        };

        let scene, camera, renderer, clock;
        let keys = {};
        let mouse = { x: 0, y: 0, down: false };
        let currentArtifactId = null;

        const ARTIFACTS_CONFIG = [
            { id: 'mask', pos: [0, 0, -15], color: 0xD4AF37 },
            { id: 'nefertiti', pos: [-15, 0, -10], color: 0xFFDAB9 },
            { id: 'scribe', pos: [15, 0, -10], color: 0x8B4513 }
        ];

        function init() {
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x050505);
            scene.fog = new THREE.Fog(0x050505, 1, 60);

            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 1.7, 5);

            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.getElementById('canvas-container').appendChild(renderer.domElement);

            clock = new THREE.Clock();

            // Ø¥Ø¶Ø§Ø¡Ø©
            scene.add(new THREE.AmbientLight(0xffffff, 0.5));
            const sun = new THREE.PointLight(0xD4AF37, 2, 50);
            sun.position.set(0, 15, 0);
            scene.add(sun);

            // Ø£Ø±Ø¶ÙŠØ© Ù…Ù„ÙƒÙŠØ©
            const floor = new THREE.Mesh(
                new THREE.PlaneGeometry(200, 200),
                new THREE.MeshStandardMaterial({ color: 0x0a0a0a, roughness: 0.1, metalness: 0.8 })
            );
            floor.rotation.x = -Math.PI / 2;
            scene.add(floor);

            // Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¢Ø«Ø§Ø±
            ARTIFACTS_CONFIG.forEach(config => {
                const group = new THREE.Group();
                const stand = new THREE.Mesh(new THREE.CylinderGeometry(1.5, 1.8, 2, 32), new THREE.MeshStandardMaterial({color: 0x111111}));
                const gem = new THREE.Mesh(new THREE.OctahedronGeometry(1.5), new THREE.MeshStandardMaterial({
                    color: config.color, emissive: config.color, emissiveIntensity: 0.3, metalness: 1, roughness: 0
                }));
                gem.position.y = 3;
                group.add(stand); group.add(gem);
                group.position.set(...config.pos);
                scene.add(group);

                const marker = document.createElement('div');
                marker.className = 'crown-marker';
                marker.innerHTML = '<i class="fas fa-crown"></i>';
                marker.onclick = () => openArtifact(config.id);
                document.getElementById('markers-layer').appendChild(marker);
                
                config.mesh = gem;
                config.markerEl = marker;
                config.worldPos = new THREE.Vector3(config.pos[0], config.pos[1] + 5, config.pos[2]);
            });

            // Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ù„Ù…Ø³ ÙˆØ§Ù„Ù…Ø§ÙˆØ³
            window.addEventListener('keydown', e => keys[e.code] = true);
            window.addEventListener('keyup', e => keys[e.code] = false);
            
            renderer.domElement.addEventListener('mousedown', () => mouse.down = true);
            window.addEventListener('mouseup', () => mouse.down = false);
            window.addEventListener('mousemove', e => {
                if(mouse.down && !currentArtifactId) {
                    camera.rotation.y -= e.movementX * 0.003;
                    camera.rotation.x -= e.movementY * 0.002;
                    camera.rotation.x = Math.max(-1, Math.min(1, camera.rotation.x));
                }
            });

            animate();
        }

        function openArtifact(id) {
            currentArtifactId = id;
            const data = ROYAL_DATABASE[id];
            document.getElementById('display-title').innerText = data.name;
            document.getElementById('interaction-panel').classList.add('active');
            showTab('story');

            document.getElementById('speak-btn').onclick = () => {
                window.speechSynthesis.cancel();
                const msg = new SpeechSynthesisUtterance(data.story);
                msg.lang = 'ar-EG';
                window.speechSynthesis.speak(msg);
            };
        }

        function showTab(tab) {
            const area = document.getElementById('content-area');
            const data = ROYAL_DATABASE[currentArtifactId];
            
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById('tab-' + tab).classList.add('active');

            if(tab === 'story') area.innerText = data.story;
            if(tab === 'rules') area.innerText = data.rules;
            if(tab === 'quiz') {
                area.innerHTML = `<p class='mb-6 font-bold text-yellow-500'>${data.quiz.q}</p>`;
                data.quiz.opts.forEach(opt => {
                    const btn = document.createElement('button');
                    btn.className = "w-full text-right p-5 mb-4 bg-zinc-900 border border-yellow-900/30 rounded-2xl hover:bg-yellow-600 hover:text-black transition-all font-bold";
                    btn.innerText = opt;
                    btn.onclick = () => {
                        if(opt === data.quiz.a) {
                            btn.className = "w-full text-right p-5 mb-4 bg-green-700 text-white rounded-2xl font-black";
                            btn.innerHTML = "âœ… Ø¥Ø¬Ø§Ø¨Ø© Ù…Ù„ÙƒÙŠØ© ØµØ­ÙŠØ­Ø©!";
                        } else { btn.style.opacity = "0.2"; }
                    };
                    area.appendChild(btn);
                });
            }
        }

        function closeUI() {
            document.getElementById('interaction-panel').classList.remove('active');
            window.speechSynthesis.cancel();
            currentArtifactId = null;
        }

        function animate() {
            requestAnimationFrame(animate);
            const delta = clock.getDelta();

            // Ø§Ù„Ø­Ø±ÙƒØ© Ø¨Ø§Ù„ÙƒÙŠØ¨ÙˆØ±Ø¯
            if(!currentArtifactId) {
                const speed = 8 * delta;
                const dir = new THREE.Vector3();
                camera.getWorldDirection(dir);
                dir.y = 0; dir.normalize();
                const side = new THREE.Vector3().crossVectors(camera.up, dir).normalize();

                if(keys['KeyW']) camera.position.addScaledVector(dir, speed);
                if(keys['KeyS']) camera.position.addScaledVector(dir, -speed);
                if(keys['KeyA']) camera.position.addScaledVector(side, speed);
                if(keys['KeyD']) camera.position.addScaledVector(side, -speed);
            }

            // ØªØ¯ÙˆÙŠØ± Ø§Ù„Ù‚Ø·Ø¹ Ø§Ù„Ø£Ø«Ø±ÙŠØ© ÙˆØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙŠØ¬Ø§Ù†
            ARTIFACTS_CONFIG.forEach(config => {
                config.mesh.rotation.y += delta;
                
                const p = config.worldPos.clone().project(camera);
                if(p.z < 1 && Math.abs(p.x) < 0.95 && Math.abs(p.y) < 0.95) {
                    config.markerEl.style.display = 'flex';
                    config.markerEl.style.left = `${(p.x * 0.5 + 0.5) * window.innerWidth}px`;
                    config.markerEl.style.top = `${(p.y * -0.5 + 0.5) * window.innerHeight}px`;
                } else {
                    config.markerEl.style.display = 'none';
                }
            });

            renderer.render(scene, camera);
        }

        document.getElementById('enter-btn').onclick = () => {
            document.getElementById('gate-screen').style.display = 'none';
            init();
        };

        window.onresize = () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        };
    </script>
</body>
</html>
